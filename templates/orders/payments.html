{% extends "base.html" %}
{% load static %}

{% block title %}Vogona Fashion Cart{% endblock %}


{% block content %}

<main class="py-20 flex-grow">
    <div class="flex justify-center p-2 text-2xl font-bold">
        <h2>Review Your Order and Make Payment</h2>
    </div>
    <div class="flex justify-center">
        <section class="w-[45%] p-5">
            <div class="flex flex-col bg-white border border-gray-300 rounded mb-1">
                <h1 class="text-lg font-bold text-gray-900 px-5 py-2">Billing Address</h1>
                <div class="py-2 border-t border-gray-300">
                    <p class="text-sm font-medium text-gray-600 px-5">{{ order.name }}</p>
                    <p class="text-sm font-medium text-gray-600 px-5">{{ order.address }}</p>
                    <p class="text-sm font-medium text-gray-600 px-5">{{ order.city }}, {{ order.state }}</p>
                    <p class="text-sm font-medium text-gray-600 px-5">{{ order.email }}</p>
                    <p class="text-sm font-medium text-gray-600 px-5">{{ order.phone }}</p>
                </div>
            </div>
            <div class="flex flex-col bg-white py-5 border border-gray-300 rounded mb-1">
                <h1 class="text-lg font-bold text-gray-900 px-5 pb-2">Payment Method</h1>
                <p class="text-sm text-gray-600 px-5 pt-2 border-t border-gray-300 font-medium">PayPal</p>
            </div>
            <div class="flex flex-col bg-white py-5 border border-gray-300 rounded mb-1">
                <h1 class="text-lg font-bold text-gray-900 px-5 pb-2 border-gray-300">Review Products</h1>
                {% for cart_item in cart_items %}

                <div class="flex bg-white p-5 border-t border-gray-300">
                    <div class="w-2/3 flex items-center gap-2">
                        <div><img class="size-14 object-cover rounded" src="{{ cart_item.product.images.url }}" alt="">
                        </div>
                        <div class="flex flex-col justify-center">
                            <h1 class="font-semibold"><a
                                    href="{{cart_item.product.get_url}}">{{cart_item.product.company_name}}</a></h1>
                            <p class="text-gray-600 text-sm font-medium"><a
                                    href="{{cart_item.product.get_url}}">{{cart_item.product.product_name}}</a></p>
                            <p class="text-gray-600 text-sm font-medium">
                                {% if cart_item.variation.all %}
                                {% for item in cart_item.variation.all %}
                                <span>{{item.variation_category|capfirst}} :
                                    {{item.variation_value|capfirst}}</span><br>
                                {% endfor %}
                                {% endif %}
                            </p>
                        </div>
                    </div>
                    <div class="w-1/3 flex justify-between">
                        <div class="w-1/2 flex items-center">
                            <p>{{cart_item.quantity}}</p>
                        </div>
                        <div class="w-1/2 flex flex-col justify-center">
                            <p class="font-semibold">Rs.<span>{{cart_item.sub_total}}</span></p>
                            <p class="text-sm text-gray-600 font-medium">Rs.<span>{{cart_item.product.price}}</span> each</p>
                        </div>
                    </div>
                </div>

                {% endfor %}
            </div>
        </section>

        <aside class="w-[25%] p-5">
            <div class="bg-white border border-gray-300 rounded py-5 px-10">
                <div class="flex justify-between items-center py-2">
                    <p class="text-sm text-gray-600 font-medium">Totle price:</p>
                    <p class="text-sm text-gray-600 font-medium">Rs.<span>{{total}}</span></p>
                </div>
                <div class="flex justify-between items-center py-2">
                    <p class="text-sm text-gray-600 font-medium">Tax:</p>
                    <p class="text-sm text-gray-600 font-medium">Rs.<span>{{tax}}</span></p>
                </div>
                <div class="flex justify-between items-center py-2">
                    <p class="font-semibold text-sm">Grand totle:</p>
                    <p class="text-sm font-semibold">Rs.<span>{{grand_total}}</span></p>
                </div>
                <div class="flex justify-center gap-3 py-2">
                    <img class="size-12" src="../../static/images/visa_card.png" alt="">
                    <img class="size-12" src="../../static/images/mastercard.png" alt="">
                    <img class="size-12" src="../../static/images/discover_card.png" alt="">
                    <img class="size-12" src="../../static/images/amex_card.png" alt="">
                </div>
                <div class="py-2">
                    <form action="{% url 'payments' %}" method="POST">
                        {% csrf_token %}

                        <div class="flex flex-col gap-2">
                            <input type="hidden" name="order_number" value="{{ order.order_number }}">
                            <div class="flex justify-center items-center">
                                <button type="submit" name="payment_method" value="paypal"
                                    class="bg-blue-500 py-2 rounded-lg text-white hover:bg-blue-600 font-semibold w-full">
                                    <p class="text-sm">Pay with <span class="text-lg">PayPal</span></p>
                                </button>
                            </div>
                            <div class="flex justify-center items-center">
                                <button type="submit" name="payment_method" value="card"
                                    class="bg-gray-700 py-2 w-full rounded-xl text-white hover:cursor-pointer hover:bg-gray-800 font-bold">
                                    <p class="text-lg">Debit or CreditCard</p>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </aside>
    </div>
</main>


{% endblock %}